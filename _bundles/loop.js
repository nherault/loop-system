!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MyLib",[],e):"object"==typeof exports?exports.MyLib=e():t.MyLib=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.safeBoolean=function(t){return void 0===t||("function"==typeof t?t():t)},e.safeCompute=function(t){t&&t()},e.sortWithOrder=function(t,e){return void 0===t||void 0===t.order?-1:void 0===e||void 0===e.order?1:t.order-e.order}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PRE="pre",t.POST="post"}(e.Pipeline||(e.Pipeline={})),function(t){t.RENDERS="renders",t.UPDATES="updates"}(e.ComputeTypes||(e.ComputeTypes={}))},function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n(3)),o(n(1))},function(t,e,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(1),s={hooks:{},maxDt:.25,renderWithTime:!1,speed:1,step:1/60},u=function(){function t(){this.dt=0,this.requestAnimationFrameId=0,this.last=window.performance.now(),this.renders=[],this.updates=[],this.options=s,this.currentOptions=s,this.isSimulationRunning=!0,this.afterFrameTasks=[]}return t.prototype.start=function(t){var e=this;return t&&(this.setOptions(t),this.setCurrentOptions(t)),this.requestAnimationFrameId=requestAnimationFrame(function(){return e.nextRequestAnimationFrame()}),this},t.prototype.stop=function(){return window.cancelAnimationFrame(this.requestAnimationFrameId),this},t.prototype.startSimulation=function(t,e){for(void 0===t&&(t=1/60),e&&(this.setOptions(e),this.setCurrentOptions(e)),this.isSimulationRunning=!0;this.isSimulationRunning;)this.frame(t);return this},t.prototype.stopSimulation=function(){return this.isSimulationRunning=!1,this},t.prototype.setCurrentOptions=function(t){var e=this;return t.speed=void 0!==t.speed?Math.max(0,t.speed):this.currentOptions.speed,this.afterFrameTasks.push(function(){e.currentOptions=o({},e.currentOptions,t)}),this},t.prototype.addAfterFrameTask=function(t){return this.afterFrameTasks.push(t),this},t.prototype.getOptions=function(){return o({},this.options)},t.prototype.getCurrentOptions=function(){return o({},this.currentOptions)},t.prototype.addCompute=function(t,e){return this[t].push(e instanceof Function?{computeFn:e}:e),this},t.prototype.removeComputes=function(t,e){var n=this;void 0!==e?(Array.isArray(e)?e:[e]).forEach(function(e){var o=n[t].findIndex(function(t){return t.id===e});-1!==o&&n[t].splice(o,1)}):this[t]=[];return this},t.prototype.setEnableComputes=function(t,e,n){var o=this;void 0!==n?(Array.isArray(n)?n:[n]).forEach(function(n){var i=o[t].findIndex(function(t){return t.id===n});-1!==i&&(o[t][i].enable=e)}):this[t].forEach(function(t){return t.enable=e});return this},t.prototype.removeAll=function(){return this.removeComputes(r.ComputeTypes.RENDERS),this.removeComputes(r.ComputeTypes.UPDATES)},t.prototype.setOptions=function(t){this.options=o({},this.options,t),this.options.speed=Math.max(0,this.options.speed)},t.prototype.nextRequestAnimationFrame=function(){var t=this,e=window.performance.now();this.frame(e),this.requestAnimationFrameId=requestAnimationFrame(function(){return t.nextRequestAnimationFrame()})},t.prototype.frame=function(t){i.safeCompute(this.currentOptions.hooks.preProcess),i.safeCompute(this.currentOptions.hooks.preUpdate),this.compute(r.ComputeTypes.UPDATES,this.currentOptions.step,r.Pipeline.PRE),this.updateWithSteps(t),this.compute(r.ComputeTypes.UPDATES,this.currentOptions.step,r.Pipeline.POST),i.safeCompute(this.currentOptions.hooks.postUpdate),i.safeCompute(this.currentOptions.hooks.preRender);var e=this.currentOptions.renderWithTime?this.currentOptions.step:0;this.compute(r.ComputeTypes.RENDERS,e,r.Pipeline.PRE),this.compute(r.ComputeTypes.RENDERS,e),this.compute(r.ComputeTypes.RENDERS,e,r.Pipeline.POST),i.safeCompute(this.currentOptions.hooks.postRender),i.safeCompute(this.currentOptions.hooks.postProcess),this.manageAfterFrame()},t.prototype.manageAfterFrame=function(){this.afterFrameTasks.forEach(function(t){t()}),this.afterFrameTasks=[]},t.prototype.updateWithSteps=function(t){for(this.dt+=this.currentOptions.speed*Math.min(this.currentOptions.maxDt,(t-this.last)/1e3);this.dt>this.currentOptions.step;)this.dt-=this.currentOptions.step,i.safeCompute(this.currentOptions.hooks.preUpdateStep),this.compute(r.ComputeTypes.UPDATES,this.currentOptions.step),i.safeCompute(this.currentOptions.hooks.postUpdateStep);this.last=t},t.prototype.compute=function(t,e,n){this[t].filter(function(t){return n===t.pipeline}).sort(i.sortWithOrder).forEach(function(t){i.safeBoolean(t.enable)&&(void 0===t.isToCompute||t.isToCompute(t,e))&&t.computeFn(e,t)})},t}();e.LoopSystemDefault=u}])});